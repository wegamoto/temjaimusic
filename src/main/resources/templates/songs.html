<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="google-adsense-account" content="ca-pub-2433635593676545">
    <title>TemjaiMusic - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;700&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Noto Sans Thai', sans-serif;
        }
    </style>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2433635593676545"
            crossorigin="anonymous"></script>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MDR55NZW');</script>
    <!-- End Google Tag Manager -->

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QWH3LXZBPB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-QWH3LXZBPB');
    </script>

</head>
<body class="bg-gray-900 text-gray-100 font-sans min-h-screen">
<div class="flex flex-col lg:flex-row max-w-[1600px] mx-auto px-4">
    <aside class="w-full lg:w-1/6 hidden lg:block p-4">
        <div class="bg-gray-800 p-4 rounded-xl shadow text-sm text-center">
            <p class="font-bold text-yellow-400 mb-2">üéØ ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</p>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2433635593676545" data-ad-slot="6779833598" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            <p class="text-gray-400 mt-2">‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</p>
        </div>
    </aside>

    <main class="w-full lg:flex-1 p-4 max-w-5xl mx-auto">
        <h1 class="text-4xl font-extrabold text-center text-blue-400 mb-10 drop-shadow-sm">üéµ TemjaiMusic - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á</h1>

        <form action="#" method="get" class="mb-8 flex flex-col md:flex-row items-stretch gap-3">
            <input type="text" name="keyword" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô" th:value="${keyword}" class="flex-1 px-5 py-3 rounded-2xl border border-gray-700 bg-gray-800 text-white focus:ring-2 focus:ring-blue-400 shadow-sm" />
            <button type="submit" class="bg-blue-500 text-white px-6 py-3 rounded-2xl shadow hover:bg-blue-600 transition">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </form>

        <div class="mb-12 flex justify-end gap-4 flex-wrap">
            <button onclick="playPlaylist()" class="bg-indigo-500 text-white px-6 py-3 rounded-2xl shadow hover:bg-indigo-600 transition">‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <a href="/songs/new" class="inline-block bg-green-500 text-white px-5 py-3 rounded-2xl shadow hover:bg-green-600 transition">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏´‡∏°‡πà</a>
        </div>

        <div class="bg-gray-800 text-white px-6 py-4 rounded-2xl flex justify-center items-center gap-6 shadow-lg w-full mt-6">
            <button onclick="toggleShuffle()" id="shuffleBtn" title="‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á">
                <svg class="w-6 h-6 opacity-50 hover:opacity-100 transition" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M4 4l16 16M20 4h-6M4 20h6M15 9l5-5M15 15l5 5"></path>
                </svg>
            </button>
            <button onclick="playPrevious()" title="‡πÄ‡∏û‡∏•‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">
                <svg class="w-6 h-6 hover:text-blue-400 transition" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M11 5.882v8.235L5 10l6-4.118zM13 5h2v10h-2V5z" />
                </svg>
            </button>
            <button onclick="togglePlay()" title="‡πÄ‡∏•‡πà‡∏ô / ‡∏´‡∏¢‡∏∏‡∏î">
                <svg id="playIcon" class="w-8 h-8 hover:text-green-400 transition" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M6 4l10 6-10 6V4z" />
                </svg>
            </button>
            <button onclick="playNext()" title="‡πÄ‡∏û‡∏•‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">
                <svg class="w-6 h-6 hover:text-blue-400 transition" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9 5.882v8.235L15 10l-6-4.118zM7 5h-2v10h2V5z" />
                </svg>
            </button>
            <button onclick="toggleRepeat()" id="repeatBtn" title="‡πÄ‡∏•‡πà‡∏ô‡∏ã‡πâ‡∏≥">
                <svg class="w-6 h-6 opacity-50 hover:opacity-100 transition" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M4 4v6h6M20 20v-6h-6M4 20h16M20 4H4"></path>
                </svg>
            </button>
        </div>

        <audio id="playlistPlayer" controls class="w-full hidden mt-4"></audio>

        <div class="h-6"></div>

        <!-- ‡πÅ‡∏ó‡∏£‡∏Å ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ -->
        <div class="mb-12 flex justify-end gap-4 flex-wrap">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2433635593676545"
                    crossorigin="anonymous"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-format="autorelaxed"
                 data-ad-client="ca-pub-2433635593676545"
                 data-ad-slot="2446772693"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <div class="flex justify-center mt-10" th:if="${totalPages > 1}">
            <ul class="inline-flex items-center space-x-1">
                <li th:if="${currentPage > 0}">
                    <a th:href="@{'/songs'(page=${currentPage - 1}, keyword=${keyword})}" class="px-3 py-2 rounded-l-lg bg-gray-700 hover:bg-blue-600 text-white">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</a>
                </li>
                <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                    <a th:href="@{'/songs'(page=${i}, keyword=${keyword})}" th:text="${i + 1}" th:classappend="${i == currentPage} ? ' bg-blue-600 text-white' : ' bg-gray-700 hover:bg-gray-600 text-gray-200'" class="px-3 py-2 rounded"></a>
                </li>
                <li th:if="${currentPage < totalPages - 1}">
                    <a th:href="@{'/songs'(page=${currentPage + 1}, keyword=${keyword})}" class="px-3 py-2 rounded-r-lg bg-gray-700 hover:bg-blue-600 text-white">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</a>
                </li>
            </ul>
        </div>

        <!-- üëá ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ -->
        <div class="text-sm text-gray-300 mb-4 text-right" th:if="${totalPages > 1}">
            ‡∏´‡∏ô‡πâ‡∏≤ <span class="text-white font-semibold" th:text="${currentPage + 1}">1</span> ‡∏à‡∏≤‡∏Å <span class="text-white font-semibold" th:text="${totalPages}">1</span>
        </div>



        <div class="grid gap-6" th:if="${songs.size() > 0}">
            <div th:each="song : ${songs}" class="bg-gray-800 rounded-3xl shadow-lg p-6 flex flex-col md:flex-row items-start md:items-center justify-between hover:shadow-xl transition-all duration-200">
                <div class="flex-1">
                    <h2 class="text-2xl font-semibold text-white mb-1" th:text="${song.title}">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á</h2>
                    <p class="text-gray-300 text-lg mb-2" th:text="${song.artist}">‡∏ä‡∏∑‡πà‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô</p>
                    <p class="text-sm text-pink-400 font-medium" th:if="${song.genre}" th:text="'‡πÅ‡∏ô‡∏ß‡πÄ‡∏û‡∏•‡∏á: ' + ${song.genre}"></p>
                    <div class="flex flex-wrap gap-2 mt-3" th:if="${song.tags}">
                        <span th:each="tag : ${song.tags}" class="bg-blue-700 text-blue-100 text-xs px-3 py-1 rounded-full shadow-sm" th:text="${tag}">Tag</span>
                    </div>
                </div>
                <div class="mt-5 md:mt-0 flex flex-wrap gap-3 items-center">
                    <audio controls th:if="${song.mp3Url != null}" th:src="${song.mp3Url}" type="audio/mpeg" class="h-10 max-w-xs rounded shadow" preload="none">Your browser does not support the audio element.</audio>
                    <a th:href="@{'/songs/' + ${song.id}}" class="bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition shadow">üé§ ‡∏î‡∏π‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏á</a>
                </div>
            </div>
        </div>

        <div class="flex justify-center mt-10" th:if="${totalPages > 1}">
            <ul class="inline-flex items-center space-x-1">
                <li th:if="${currentPage > 0}">
                    <a th:href="@{'/songs'(page=${currentPage - 1}, keyword=${keyword})}" class="px-3 py-2 rounded-l-lg bg-gray-700 hover:bg-blue-600 text-white">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</a>
                </li>
                <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                    <a th:href="@{'/songs'(page=${i}, keyword=${keyword})}" th:text="${i + 1}" th:classappend="${i == currentPage} ? ' bg-blue-600 text-white' : ' bg-gray-700 hover:bg-gray-600 text-gray-200'" class="px-3 py-2 rounded"></a>
                </li>
                <li th:if="${currentPage < totalPages - 1}">
                    <a th:href="@{'/songs'(page=${currentPage + 1}, keyword=${keyword})}" class="px-3 py-2 rounded-r-lg bg-gray-700 hover:bg-blue-600 text-white">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</a>
                </li>
            </ul>
        </div>

        <div th:if="${songs.size() == 0}" class="text-center text-gray-300 bg-gray-800 p-6 rounded-2xl border border-gray-700 mt-10 shadow">
            <p class="text-xl font-medium mb-2">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
            <p th:if="${keyword}" class="text-base">‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô: <span class="font-semibold text-white" th:text="${keyword}"></span></p>
            <a href="/songs" class="mt-4 inline-block text-blue-400 hover:underline">üîÅ ‡∏î‡∏π‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
        </div>
    </main>

    <aside class="w-1/6 hidden lg:block p-4">
        <div class="bg-gray-800 p-4 rounded-xl shadow text-sm text-center">
            <p class="font-bold text-yellow-400 mb-2">üí° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2433635593676545" data-ad-slot="6779833598" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            <p class="text-gray-400 mt-2">‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏´‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏Ñ‡∏£!</p>
        </div>
    </aside>
</div>

<script>
    let playlist = [];
    let currentTrackIndex = 0;
    let isShuffle = false;
    let isRepeat = false;

    const player = document.getElementById("playlistPlayer");
    const playIcon = document.getElementById("playIcon");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const repeatBtn = document.getElementById("repeatBtn");

    function buildPlaylist() {
        playlist = Array.from(document.querySelectorAll("audio"))
            .map(a => a.src)
            .filter(url => url && url.startsWith("http"));
    }

    function playPlaylist() {
        buildPlaylist();
        if (playlist.length === 0) return alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô");
        currentTrackIndex = 0;
        player.src = playlist[currentTrackIndex];
        player.classList.remove("hidden");
        player.play();
    }

    function playNext() {
        currentTrackIndex = isShuffle ? Math.floor(Math.random() * playlist.length) : (currentTrackIndex + 1) % playlist.length;
        player.src = playlist[currentTrackIndex];
        player.play();
    }

    function playPrevious() {
        currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
        player.src = playlist[currentTrackIndex];
        player.play();
    }

    function togglePlay() {
        if (!player.src || player.src === window.location.href) {
            playPlaylist();
            playIcon.innerHTML = '<path d="M6 4h4v12H6zM10 4h4v12h-4z"/>';
            return;
        }
        if (player.paused) {
            player.play();
            playIcon.innerHTML = '<path d="M6 4h4v12H6zM10 4h4v12h-4z"/>';
        } else {
            player.pause();
            playIcon.innerHTML = '<path d="M6 4l10 6-10 6V4z"/>';
        }
    }

    function toggleShuffle() {
        isShuffle = !isShuffle;
        shuffleBtn.classList.toggle("text-yellow-400", isShuffle);
    }

    function toggleRepeat() {
        isRepeat = !isRepeat;
        repeatBtn.classList.toggle("text-green-400", isRepeat);
    }

    player.addEventListener("ended", () => {
        if (isRepeat) {
            player.play();
        } else {
            playNext();
        }
    });
</script>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MDR55NZW"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<!-- ‡πÅ‡∏™‡∏î‡∏á Fragment Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>
